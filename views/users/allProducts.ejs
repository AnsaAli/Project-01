<%- include('../layout/header.ejs') %>
  <!-- <%- include('../layout/cartAndwishlist.ejs') %> -->

    <body>

      <section class="product-tabs pt-25 pb-20 wow fadeIn animated">
        <div class="container">
          <div class="row">
            <div class="col-lg-3">

              <div class="widget-category mb-30">

                <h5 class="section-title style-1 mb-30 wow fadeIn animated">Category</h5>
                <ul class="categories">
                  <% categories.forEach(category=> { %>
                    <li><a href="/allProducts?category=<%= category._id %>" style="border-radius: 5px;">
                        <%= category.name %>
                      </a><br></li>
                    <% }); %>
                </ul>
              </div>

              <div class="m-5">
                <ul class="categories">
                  <li> <a href="/allProducts" style="border-radius: 5px;">Clear Filter</a>
                  </li>
                </ul>
              </div>

              <div class="widget-category mb-30">
                <h5 class="section-title style-1 mb-30 wow fadeIn animated">Sort by</h5>
                <ul class="categories">
                  <li><a href="/allProducts?sortby=onOffer">On Offer</a></li>
                  <li><a href="/allProducts?sortby=lowerPrice">Price: Low to High</a></li>
                  <li><a href="/allProducts?sortby=higherPrice">Price: High to Low</a></li>
                </ul>
              </div>

            </div>

            <!-- search -->
            <div class="col-lg-9">
              <div class="tab-header mb-15">
                <div class="row product-grid-4">
                  <div class="col-lg-12 col-md-8 col-12 col-sm-6">
                    <form action="/allProducts" method="GET" class="d-flex">
                      <label for="searchQuery"></label>
                      <input type="text" class="  mr-2 " id="searchQuery" name="searchQuery" placeholder="Search ">
                      <button type="submit" class="btn btn-primary btn-sm" style="border-radius: 5px;"><i
                          class="fa fa-search"></i>Search</button>
                    </form>
                  </div>
                </div>
              </div>


              <!--End nav-tabs-->
              <div class="tab-content wow fadeIn animated mt-5" id="myTabContent">
                <div class="tab-pane fade show active" id="tab-one" role="tabpanel" aria-labelledby="tab-one">

                  <div class="row product-grid-4">
                    <% products.forEach(product=> { %>
                      <div class="col-lg-4 col-md-4 col-12 col-sm-6">

                        <div class="product-cart-wrap mb-30">
                          <div class="product-img-action-wrap">
                            <div class="product-img product-img-zoom">

                              <a href="">

                                <img src="<%= product.images[0].url %>" alt="Product Image"
                                  class="img-fluid mx-auto d-block" alt="Product Image" style="width:100%">

                              </a>
                            </div>
                            <div class="product-action-1">
                              <!-- <a aria-label="Quick view" class="action-btn hover-up" data-bs-toggle="modal" href="/viewProduct"
                                data-bs-target="#quickViewModal"><i class="fi-rs-eye"></i>
                              </a>
                              <a aria-label="Add To Wishlist" class="action-btn hover-up" href="shop-wishlist.html"><i
                                  class="fi-rs-heart"></i></a>
                              <a aria-label="Compare" class="action-btn hover-up" href="shop-compare.html"><i
                                  class="fi-rs-shuffle"></i></a> -->
                            </div>
                            <div class="product-badges product-badges-position product-badges-mrg">
                              <!-- <span class="hot">
                             
                              </span> -->
                            </div>
                          </div>
                          <div class="product-content-wrap">
                            <div class="product-category">
                              <a href="shop-grid-right.html">
                                <%= product.category.name %>
                              </a>
                            </div>
                            <h2><a href="shop-product-right.html">
                                <%= product.productName %>
                              </a></h2>
                              <!-- rating -->
                            <div  title="90%"> 
                              <!-- <span>
                                <span>90%</span>
                              </span> -->
                            </div>
                            <div class="product-price">
                              <% if(product.totalQuantity <=0 ) {%> <p style="color: red;">Out Of Stock </p> <% }%>
                              <select name="selectedProduct">
                                <% product.weightOptions.forEach(option=> { %>
                                  <option
                                    value="<%= option.weight %>,<%= option.weightPrice.toFixed(2) %>,<%= option.priceAfterDiscount %>">
                                    <%= option.weight %>g
                                      <% if (product.offerPercentage !==0) { %>
                                        <strong>
                                          <p>on offer</p>
                                        </strong>
                                        ₹<%= option.priceAfterDiscount.toFixed(2) %>
                                          <% } else { %>
                                            ₹<%= option.weightPrice.toFixed(2) %>
                                              <% } %>
                                  </option>
                                  <% }) %>
                              </select>
                            </div>
                            <div class="buy-btn">
                              <form action="/viewProduct" method="GET">
                                <input type="hidden" value="<%=product._id %>" name="productId">
                                <button>Details</button>
                              </form>

                            </div>
                          </div>
                        </div>
                      </div>
                      <% }); %>
                  </div>
                  <!-- <h3>pagination</h3> -->
                  <div class="pagination">
                    <% if (currentPage> 1) { %>
                      <a href="/allProducts?page=<%= currentPage - 1 %>">&laquo; Previous</a>
                      <% } %>
                        <% if (products.length===perPage) { %>
                          <a href="/allProducts?page=<%= currentPage + 1 %>">Next &raquo;</a>
                          <% } %>
                </div>
                <!--End tab-content-->
              </div>
            </div>
          </div>
        
          </div>
         
      </section>

     
        






      <style>
        .buy-btn {
          display: flex;
          justify-content: center;
          align-items: center;
          width: 35%;
        }

        .buy-btn button {
          cursor: pointer;
          padding: 10px 20px;
          border: 1px solid #046963;
          background: #046963;
          color: #fff;
          box-shadow: 0 19px 38px rgba(0, 0, 0, 0.30),
            0 15px 12px rgba(0, 0, 0, 0.22);
          border-radius: 25px;
        }
      </style>
      <script>

      </script>

    </body>



    <%- include('../layout/footer.ejs') %>