<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <!-- Include necessary libraries -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="path/to/your/styles.css">

  <style>
    .chart-container-1 {
      background-color: rgba(255, 255, 255, 0.8);
      /* Adjust the opacity as needed */
      padding: 10px;
      border-radius: 10px;
    }
  </style>
</head>

<body>
  <%- include('../layout/adminHeader.ejs') %>
    <!-- dashboard -->
    <div class="content">
      <div class="row">
        <div class="col-lg-12">
          <div class="card mt-3">
            <div class="card-content">
              <div class="row row-group m-0">
                <div class="col-12 col-lg-6 col-xl-3 border-light">
                  <div class="card-body">
                    <h5 class="text-white mb-0">
                      <% if(total.length==0){ %>
                        ₹ <span>0</span>
                        <% }else{ %>
                          <p class="text-lg font-semibold text-black-700 dark:text-gray-200">₹ <%=total[0].total%>
                          </p>
                          <% } %><span class="float-right"></span>
                    </h5>
                    <div class="progress my-3" style="height:3px;">
                      <div class="progress-bar" style="width:55%"></div>
                    </div>
                    <p class="mb-0 text-black small-font">Total Revenue </span></p>
                  </div>
                </div>

                <div class="col-12 col-lg-6 col-xl-3 border-light">
                  <div class="card-body">
                    <h5 class="text-black mb-0">
                      <%= user_count %> <span class="float-right"></span>
                    </h5>
                    <div class="progress my-3" style="height:3px;">
                      <div class="progress-bar" style="width:55%"></div>
                    </div>
                    <p class="mb-0 text-black small-font">Total Users </span></p>
                  </div>
                </div>

                <div class="col-12 col-lg-6 col-xl-3 border-light">
                  <div class="card-body">
                    <h5 class="text-black mb-0">
                      <%= order_count %> <span class="float-right"></span>
                    </h5>
                    <div class="progress my-3" style="height:3px;">
                      <div class="progress-bar" style="width:55%"></div>
                    </div>
                    <p class="mb-0 text-black small-font">Total orders </span></p>
                  </div>
                </div>

                <div class="col-12 col-lg-6 col-xl-3 border-light">
                  <div class="card-body">
                    <h5 class="text-black mb-0">
                      <%= product_count %> <span class="float-right"></span>
                    </h5>
                    <div class="progress my-3" style="height:3px;">
                      <div class="progress-bar" style="width:55%"></div>
                    </div>
                    <p class="mb-0 text-black small-font">Total products </span></p>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-12 col-lg-8 col-xl-8">
          <div class="card">
            <div class="card-header">Monthly Report
              <div class="card-action">
                <div class="dropdown">
                  <a href="javascript:void();" class="dropdown-toggle dropdown-toggle-nocaret" data-toggle="dropdown">
                    <i class="icon-options"></i>
                  </a>
                  <div class="dropdown-menu dropdown-menu-right">
                    <a class="dropdown-item" href="javascript:void();">Action</a>
                    <a class="dropdown-item" href="javascript:void();">Another action</a>
                    <a class="dropdown-item" href="javascript:void();">Something else here</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="javascript:void();">Separated link</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <ul class="list-inline">
                <li class="list-inline-item"><i class="fa fa-circle mr-2 text-white"></i>Revenue</li>
                <li class="list-inline-item"></li>
              </ul>
              <div class="chart-container-1">
                <canvas id="monthlySalesChart"></canvas>
              </div>
            </div>

            <% for (let i=0; i < month.length; i++) { %>
              <input type="hidden" id="input<%= i + 1 %>" value="<%= month[i] %>">
              <% } %>

                <div class="row m-0 row-group text-center border-top border-light-3">
                  <div class="col-12 col-lg-4">
                    <div class="p-3">
                      <!-- <h5 class="mb-0">45.87M</h5> -->
                      <!-- <small class="mb-0">Overall Visitor <span> <i class="fa fa-arrow-up"></i> 2.43%</span></small> -->
                    </div>
                  </div>
                  <div class="col-12 col-lg-4">
                    <div class="p-3">
                      <!-- <h5 class="mb-0">15:48</h5> -->
                      <!-- <small class="mb-0">Visitor Duration <span> <i class="fa fa-arrow-up"></i> 12.65%</span></small> -->
                    </div>
                  </div>
                  <div class="col-12 col-lg-4">
                    <div class="p-3">
                      <!-- <h5 class="mb-0">245.65</h5> -->
                      <!-- <small class="mb-0">Pages/Visit <span> <i class="fa fa-arrow-up"></i> 5.62%</span></small> -->
                    </div>
                  </div>
                </div>

          </div>
        </div>
      </div>

      <!-- Daily Sales Chart -->
      <div class="row">
        <div class="col-12 col-lg-8 col-xl-8">
          <div class="card">
            <div class="card-header">Daily Report</div>
            <div class="card-body">
              <div class="chart-container-1">
                <canvas id="dailyOrderChart"></canvas>
              </div>
            </div>
            <% for (let i=0; i < daily.length; i++) { %>
              <input type="hidden" id="dailyInput<%= i %>" value="<%= daily[i] %>">
              <% } %>
          </div>
        </div>
      </div>
    </div>

    <script>
      $(document).ready(function () {
        // Initialize charts when the document is ready
        const monthlySalesData = [];
        for (let i = 1; i <= 12; i++) {
          monthlySalesData.push(Number(document.getElementById(`input${i}`).value));
        }

        const dailySalesData = JSON.parse(`<%- JSON.stringify(daily) %>`.replace(/&quot;/g, '"')).map(Number);

        var ctxMonthly = document.getElementById('monthlySalesChart').getContext('2d');
        var monthlyChart = new Chart(ctxMonthly, {
          type: 'bar',
          data: {
            labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
            datasets: [{
              label: 'Sales',
              data: monthlySalesData,
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              borderColor: "transparent",
              borderWidth: 3
            }]
          },
          options: {
            maintainAspectRatio: false,
            legend: {
              display: false,
              labels: {
                fontColor: '#ddd',
                boxWidth: 40
              }
            },
            tooltips: {
              displayColors: false
            },
            scales: {
              xAxes: [{
                ticks: {
                  beginAtZero: true,
                  fontColor: '#ddd'
                },
                gridLines: {
                  display: true,
                  color: "rgba(221, 221, 221, 0.08)"
                },
              }],
              yAxes: [{
                ticks: {
                  beginAtZero: true,
                  fontColor: '#ddd'
                },
                gridLines: {
                  display: true,
                  color: "rgba(221, 221, 221, 0.08)"
                },
              }]
            }
          }
        });

        var ctxDaily = document.getElementById('dailyOrderChart').getContext('2d');
        var dailyChart = new Chart(ctxDaily, {
          type: 'bar',
          data: {
            labels: dailySalesData.map((sale, index) => index + 1),
            datasets: [{
              label: 'Daily Sales',
              data: dailySalesData,
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              borderColor: "transparent",
              borderWidth: 3
            }]
          },
          options: {
            maintainAspectRatio: false,
            legend: {
              display: false,
              labels: {
                fontColor: '#ddd',
                boxWidth: 40
              }
            },
            tooltips: {
              displayColors: false
            },
            scales: {
              xAxes: [{
                ticks: {
                  beginAtZero: true,
                  fontColor: '#ddd'
                },
                gridLines: {
                  display: true,
                  color: "rgba(221, 221, 221, 0.08)"
                },
              }],
              yAxes: [{
                ticks: {
                  beginAtZero: true,
                  fontColor: '#ddd'
                },
                gridLines: {
                  display: true,
                  color: "rgba(221, 221, 221, 0.08)"
                },
              }]
            }
          }
        });
      });
    </script>
</body>

</html>