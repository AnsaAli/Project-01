<%- include('../layout/adminHeader.ejs') %>

  <div class="content">
    <div class="row">
      <div class="col-md-8">
        <div class="card p-5">
          <div class="card-header">
            <h5 class="title">Edit Product</h5>
          </div>
          <div class="card-body">
            <form action="/admin/editProduct" method="POST" enctype="multipart/form-data">

          </div>
          <!-- <div class="row">
              <div class="col-md-5 pr-1 form-group">
                      <button class="btn btn-fill-out btn-block hover-up" onclick="cropAndSaveImages()">Crop & Save Images</button>
              </div>
           -->

          <div class="row">
            <div class="col-md-6 pr-1">
              <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" class="form-control" id="name" name="name" value="<%= products.name %>" required>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 pr-1">
              <div class="form-group">
                <label for="category">Category:</label>
                <!-- <input type="text"  class="form-control" id="category" name="category" value="<%= products.category.name %>"> -->
                <select class="form-control" name="category" id="category">
                  <% categories.forEach(category=>{%>
                    <option value="<%= category._id %>">
                      <%= category.name%>
                    </option>

                    <%} )%>
                </select>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 pr-1">
              <div class="form-group">
                <label for="stock">Stock</label>
                <input type="number" id="stock" class="form-control" name="stock" value="<%= products.stock %>"
                  required>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 pr-1">
              <div class="form-group">
                <label for="quantity">Quantity</label>
                <input type="number" id="quantity" class="form-control" name="quantity" value="<%= products.quantity %>"
                  required>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 pr-1">
              <div class="form-group">
                <label for="total_price">Total Price(₹)/g</label>
                <input type="number" id="total_price" class="form-control" name="total_price"
                  value="<%= products.total_price %>" required>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6 pr-1">
              <div class="form-group">
                <label for="offer_price">Offer Price(₹)/g</label>
                <input type="number" id="offer_price" class="form-control" name="offer_price"
                  value="<%= products.offer_price %>" required>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6 pr-1">
              <div class="form-group">
                <label for="description">Description:</label>
                <textarea name="description" rows="4" cols="80" class="form-control" id="description"
                  required><%= products.description %></textarea>
              </div>
            </div>
          </div>
          <input type="hidden" name="id" value="<%= products._id %>">
          <div class="row">
            <div class="col-md-12">
              <div class="form-group">

                <button type="submit" class="btn btn-fill-out btn-block hover-up">Update Product</button>
                <button type="submit" class="btn btn-fill-out btn-block hover-up"><a
                    href="/admin/viewProducts">Cancel</a></button>

              </div>
            </div>
          </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  </div>


  <footer class="footer">
    <div class=" container-fluid ">
      <nav>
        <ul>
          <li>
            <a href="https://www.creative-tim.com">
              GoEasy-Admin
            </a>
          </li>
          <li>
            <a href="http://presentation.creative-tim.com">
              About Us
            </a>
          </li>
          <li>
            <a href="">
              Blog
            </a>
          </li>
        </ul>
      </nav>
      <div class="copyright" id="copyright">
        &copy;
        <script>
          document.getElementById('copyright').appendChild(document.createTextNode(new Date().getFullYear()))
        </script>, Designed by <a href="https://www.invisionapp.com" target="_blank">Invision</a>. Coded by <a
          href="https://www.creative-tim.com" target="_blank">Creative Tim</a>.
      </div>
    </div>
  </footer>
  </div>
  </div>

  <style>
    .preview-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .preview-image {
      max-width: 200px;
      height: auto;
      border: 1px solid #ccc;
    }

    .cropped-image {
      max-width: 200px;
      height: auto;
      border: 1px solid #ccc;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>
  <script>
    // const containers = [];

    // async function previewAndCropImages(event) {
    //   const preview = document.getElementById('imagePreview');
    //   preview.innerHTML = ''; // Clear previous previews

    //   const files = event.target.files; // Get selected files

    //   for (let i = 0; i < files.length; i++) {
    //     const file = files[i];
    //     const reader = new FileReader();

    //     reader.onload = function (e) {
    //       const img = document.createElement('img');
    //       img.src = e.target.result;
    //       img.classList.add('preview-image');

    //       // Create a container for each image
    //       const container = document.createElement('div');
    //       container.classList.add('preview-container');

    //       // Append the image to the container
    //       container.appendChild(img);
    //       preview.appendChild(container);

    //       // Initialize Cropper
    //       const cropper = new Cropper(img, {
    //         aspectRatio: NaN, // Allow free aspect ratio
    //         viewMode: 1, // Set view mode
    //         crop(event) {
    //           const cropperData = cropper.getData();
    //           document.getElementById('cropWidth').value = Math.round(cropperData.width);
    //           document.getElementById('cropHeight').value = Math.round(cropperData.height);
    //         }
    //         // Add more options as needed
    //       });

    //       // Store Cropper instance with the image element
    //       img.cropper = cropper;
    //     };

    //     reader.readAsDataURL(file);
    //   }
    // }


    // function cropAndSaveImages() {
    //   const previewImages = document.querySelectorAll('.preview-image');

    //   previewImages.forEach(img => {
    //     // Get cropped data
    //     const cropper = img.cropper;
    //     if (cropper) {
    //       const cropWidth = document.getElementById('cropWidth').value;
    //       const cropHeight = document.getElementById('cropHeight').value;
    //       const croppedDataUrl = cropper.getCroppedCanvas({
    //         width: parseInt(cropWidth),
    //         height: parseInt(cropHeight)
    //       }).toDataURL();

    //       // Create a new container for the cropped image
    //       const container = document.createElement('div');
    //       container.classList.add('preview-container');

    //       // Display the cropped image
    //       const croppedImg = document.createElement('img');
    //       croppedImg.src = croppedDataUrl;
    //       croppedImg.classList.add('cropped-image');
    //       container.appendChild(croppedImg);

    //       // Display the width and height
    //       const widthLabel = document.createElement('span');
    //       widthLabel.textContent = 'Width: ' + cropWidth;
    //       container.appendChild(widthLabel);

    //       const heightLabel = document.createElement('span');
    //       heightLabel.textContent = 'Height: ' + cropHeight;
    //       container.appendChild(heightLabel);

    //       // Append the container to the list
    //       containers.push(container);
    //       // console.log('Checking cropped image:', croppedDataUrl);
    //     }
    //   });

    //   // Display the cropped images in separate containers
    //   const imagesContainer = document.getElementById('imagePreview');
    //   imagesContainer.innerHTML = ''; // Clear previous previews
    //   containers.forEach(container => {
    //     imagesContainer.appendChild(container);
    //   });

    //   // Save the cropped images
    //   containers.forEach(container => {
    //     const croppedImg = container.querySelector('.cropped-image');
    //     const dataUrl = croppedImg.src;
    //     console.log('Saved image:', dataUrl);

    //   });
    // }
  </script>

  </body>

  </html>